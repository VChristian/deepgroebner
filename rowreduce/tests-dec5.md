Test: direct fitting the q-function to k-interactions
Date: 5 Dec 2018
Commit: 1badb5a

The purpose of these first tests is to determine if the k-interactions model could even fit the
Q-function. To do this we have implemented a function which directly computes the Q-values
for a reasonable good policy (pick the row with min (but not 0) other 1s in it's lead column).
Then we train the model directly to the output of this function (so this is essentially
supervised learning where the data is states mapped to Q-values). If the k-interactions model
cannot learn the given Q-functon directly then it is unlikely to be able to learn when actually
performing Q-learning.

To generate the agents run

    python3 -i main.py

from this directory. This will put agents in the `model/` directory. The options for training
were chosen after a bit of exploration, but could likely be improved. This took about 3 hours
on my laptop. Training logs were

    training 2-2:
    Epoch 1/1
    10000/10000 [==============================] - 4s 377us/step - loss: 96.0991
    Epoch 1/1
    10000/10000 [==============================] - 2s 227us/step - loss: 64.7968
    Epoch 1/1
    10000/10000 [==============================] - 2s 227us/step - loss: 33.4967
    Epoch 1/1
    10000/10000 [==============================] - 2s 226us/step - loss: 10.8457
    Epoch 1/1
    10000/10000 [==============================] - 2s 227us/step - loss: 7.9664
    Epoch 1/1
    10000/10000 [==============================] - 2s 227us/step - loss: 7.7856
    Epoch 1/1
    10000/10000 [==============================] - 2s 229us/step - loss: 7.8892
    Epoch 1/1
    10000/10000 [==============================] - 2s 226us/step - loss: 7.8765
    Epoch 1/1
    10000/10000 [==============================] - 2s 229us/step - loss: 7.8269
    Epoch 1/1
    10000/10000 [==============================] - 2s 227us/step - loss: 7.8225

    training 2-3:
    Epoch 1/1
    10000/10000 [==============================] - 5s 534us/step - loss: 156.0486
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 124.7492
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 93.4522
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 64.9828
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 53.4154
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 46.0276
    Epoch 1/1
    10000/10000 [==============================] - 4s 362us/step - loss: 43.2883
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 43.1763
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 42.8991
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 43.1430
    Epoch 1/1
    10000/10000 [==============================] - 4s 364us/step - loss: 43.4893
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 42.9600
    Epoch 1/1
    10000/10000 [==============================] - 4s 362us/step - loss: 42.8110
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 42.8441
    Epoch 1/1
    10000/10000 [==============================] - 4s 362us/step - loss: 43.1512
    Epoch 1/1
    10000/10000 [==============================] - 4s 362us/step - loss: 42.9769
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 43.0846
    Epoch 1/1
    10000/10000 [==============================] - 4s 361us/step - loss: 43.1139
    Epoch 1/1
    10000/10000 [==============================] - 4s 365us/step - loss: 43.2028
    Epoch 1/1
    10000/10000 [==============================] - 4s 363us/step - loss: 43.1326

    training 2-4:
    Epoch 1/1
    100000/100000 [==============================] - 52s 515us/step - loss: 127.6920
    Epoch 1/1
    100000/100000 [==============================] - 50s 500us/step - loss: 43.3395
    Epoch 1/1
    100000/100000 [==============================] - 50s 500us/step - loss: 42.7575
    Epoch 1/1
    100000/100000 [==============================] - 52s 516us/step - loss: 42.7348
    Epoch 1/1
    100000/100000 [==============================] - 51s 507us/step - loss: 42.6095

    training 2-5:
    Epoch 1/1
    100000/100000 [==============================] - 109s 1ms/step - loss: 204.6107
    Epoch 1/1
    100000/100000 [==============================] - 72s 718us/step - loss: 53.8130
    Epoch 1/1
    100000/100000 [==============================] - 71s 714us/step - loss: 47.2559
    Epoch 1/1
    100000/100000 [==============================] - 71s 711us/step - loss: 47.1803
    Epoch 1/1
    100000/100000 [==============================] - 71s 713us/step - loss: 47.1743

    training 2-10:
    Epoch 1/1
    100000/100000 [==============================] - 661s 7ms/step - loss: 617.2261
    Epoch 1/1
    100000/100000 [==============================] - 210s 2ms/step - loss: 304.7260
    Epoch 1/1
    100000/100000 [==============================] - 168s 2ms/step - loss: 57.0355
    Epoch 1/1
    100000/100000 [==============================] - 166s 2ms/step - loss: 30.8083
    Epoch 1/1
    100000/100000 [==============================] - 168s 2ms/step - loss: 30.7829

    training 3-3:
    Epoch 1/1
    10000/10000 [==============================] - 7s 675us/step - loss: 157.2742
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 125.9725
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 94.6722
    Epoch 1/1
    10000/10000 [==============================] - 4s 420us/step - loss: 64.7197
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 38.6235
    Epoch 1/1
    10000/10000 [==============================] - 4s 420us/step - loss: 25.0213
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 22.7321
    Epoch 1/1
    10000/10000 [==============================] - 4s 420us/step - loss: 21.2086
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 19.5436
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 18.1260
    Epoch 1/1
    10000/10000 [==============================] - 4s 421us/step - loss: 17.8370
    Epoch 1/1
    10000/10000 [==============================] - 4s 420us/step - loss: 16.9885
    Epoch 1/1
    10000/10000 [==============================] - 4s 420us/step - loss: 16.1957
    Epoch 1/1
    10000/10000 [==============================] - 4s 419us/step - loss: 15.5704
    Epoch 1/1
    10000/10000 [==============================] - 4s 422us/step - loss: 14.6765
    Epoch 1/1
    10000/10000 [==============================] - 4s 421us/step - loss: 13.9065
    Epoch 1/1
    10000/10000 [==============================] - 4s 421us/step - loss: 13.1780
    Epoch 1/1
    10000/10000 [==============================] - 4s 423us/step - loss: 13.5815
    Epoch 1/1
    10000/10000 [==============================] - 4s 425us/step - loss: 12.6213
    Epoch 1/1
    10000/10000 [==============================] - 4s 422us/step - loss: 12.6588

    training 3-4:
    Epoch 1/1
    100000/100000 [==============================] - 947s 9ms/step - loss: 121.1208
    Epoch 1/1
    100000/100000 [==============================] - 121s 1ms/step - loss: 33.3693
    Epoch 1/1
    100000/100000 [==============================] - 82s 823us/step - loss: 32.1197
    Epoch 1/1
    100000/100000 [==============================] - 81s 813us/step - loss: 31.7838
    Epoch 1/1
    100000/100000 [==============================] - 80s 805us/step - loss: 31.3822

    training 3-5:
    Epoch 1/1
    100000/100000 [==============================] - 151s 2ms/step - loss: 203.4519
    Epoch 1/1
    100000/100000 [==============================] - 148s 1ms/step - loss: 48.5313
    Epoch 1/1
    100000/100000 [==============================] - 243s 2ms/step - loss: 42.5333
    Epoch 1/1
    100000/100000 [==============================] - 156s 2ms/step - loss: 41.9772
    Epoch 1/1
    100000/100000 [==============================] - 152s 2ms/step - loss: 41.6187